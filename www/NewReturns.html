<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title> Application ISEI </title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
       <!--  <link rel="stylesheet" type="text/css" href="css/index.css" /> <!--à ajouter-->
         
         <link rel="stylesheet" href="css/themes/MonTheme.css" />
         <link rel="stylesheet" href="css/themes/jquery.mobile.icons.min.css" />
         <link rel="stylesheet" href="css/jquery.mobile.structure-1.4.5.min.css" />
         <link rel="stylesheet" href="css/themes/Custom.css" /> <!--change la couleur du placeholder-->
               
               
        <script src="js/jquery.js"></script>
        <script src="js/jquery.mobile-1.4.5.min.js"></script>
        
        <script type="text/javascript">
         
         
         $(document).on("swipeleft",function(event,ui){
             //en touchant l'ecran vers la gauche on ouvre le panel 
             $("#myPanel").panel("open");
         });
         
         
            
          window.onload= function(){
              
               document.getElementById("enregistrer").addEventListener('click', storeData
                      , false);
              
               document.getElementById("rec").addEventListener('click', loadData
                      , false);
                      
               document.getElementById("reset").addEventListener('click', clearData
                      , false);
                      
                      document.getElementById("yesErase").addEventListener('click', function () {
                          
                         // localStorage.clear();
                          
                          $.when(localStorage.clear()).then(function( ) {
                              
                              var NoSir=("#cancel").clicked;
                              
                               $( "#popup2" ).popup({            //juste après la fermeture du popup2
                              afterclose: function() {
                              
                                 $( "#popup3" ).popup( "open" );
                                   
                                   
                                   
                              }
                               });
                               
                               //$("#popup3").hide().removeClass('visible');
                               
                             if (NoSir) return false;
                                            });
                          
                         
                          
                          
                        //   var YesSir= $("yesErase").click(function(){});
                          
                          
                        //   //var NoSir=("#cancel").clicked
                          
                        //   $( "#popup2" ).popup({            //juste après la fermeture du popup2
                        //       afterclose: function() {
                        //       if  (YesSir)  {
                        //           $( "#popup3" ).popup( "open" );
                                   
                                  
                        //       }   
                                  
                        //       else {
                              
                        //      //$("#popup3").fadeOut().removeClass("active");// n'affiche pas popup3
                        //      $("#popup3").hide().removeClass('visible');
                             
                        //       }
                        //       }
                        //         });
                          
                          
                         $( "#popup2" ).popup( "close" );
                         
                          
                      }
                      , false);
                      
                    document.getElementById("cancel").addEventListener('click', function () {
                        
                        $( "#popup2" ).popup( "close" );
                        //$("#popup3").hide().removeClass('visible');
                        //$("#popup3").fadeOut().removeClass("active");
                    }
                      , false);  
                      
                      
               
                //  $('#yes1').click(function () {
                //      alert('test');
                //  });
              
          };
          
          
          
          
          
          function storeData(){
            
            var radioval =$('input[name="gender"]:Checked').val();// value radio
            
            
            var fname= document.getElementById('fname').value;
            
            
            var lname= document.getElementById('lname').value;
            
            var bday= document.getElementById('bday').value;
            
            
            
            var slider1 =document.getElementById('slider1').value;
            
            var slider2 =document.getElementById('slider2').value;
            
            var nation =document.getElementById('nation').value;
            
            
            var ID =document.getElementById('ID').value;
            
            var select =document.getElementById('select').value;
            
            var patho =document.getElementById('patho').value;
            
            
            var chir =document.getElementById('chir').value;
            
            var allerg =document.getElementById('allerg').value;
            
            var treat =document.getElementById('treat').value;
            
            var doctor =document.getElementById('doctor').value;
            
            var spe =document.getElementById('spe').value;
            
            var donselect =document.getElementById('donselect').value;
            
            localStorage.setItem('fname' , fname);
            
            
            localStorage.setItem('lname' , lname);
            
            localStorage.setItem('bday' , bday);
            
            localStorage.setItem('sexe' , radioval);
            
            localStorage.setItem('slider1' , slider1);
            
            localStorage.setItem('slider2' , slider2);
            
            
            localStorage.setItem('nation' , nation);
            localStorage.setItem('ID' , ID);
            
            localStorage.setItem('select' , select);
            
            localStorage.setItem('patho' , patho);
              
            localStorage.setItem('chir' , chir);  
             
            localStorage.setItem('allerg' , allerg);
            
            localStorage.setItem('treat' , treat); 
            
            localStorage.setItem('doctor' , doctor); 
            
            localStorage.setItem('spe' , spe); 
              
            localStorage.setItem('donselect' , donselect); 
            
            
            
            $( "#popup1" ).popup( "open" );
          }
          
          
                
                
          function loadData(){
              //test
             
               
             //var myWin=$.mobile.changePage('#page4');
                   
                
               
              
            
           //test popup
           
           //var myWin=$( "#popup1" ).popup( "open" );
           
        //test failed conclusion
            //var site="#page4";
            //var myWin = window.open("","","menubar=0,scrollbars=0");
            //myWin.document.write('#page4');
            
          //fin test  
            
            //var myWin = window.open("#page4", "_parent","width=600,height=900");//à modifier!!!!!!!!!!!!
          
           
            
        
           var fname = localStorage.getItem('fname');
           var lname = localStorage.getItem('lname');
           var bday = localStorage.getItem('bday');
           var sexe = localStorage.getItem('sexe');
           
           
           var slider1 = localStorage.getItem('slider1');
           var slider2 = localStorage.getItem('slider2');
           var nation = localStorage.getItem('nation');
           var ID = localStorage.getItem('ID');
           var select = localStorage.getItem('select');
           var patho = localStorage.getItem('patho');
          
           var chir = localStorage.getItem('chir');
           var allerg = localStorage.getItem('allerg');
           var treat = localStorage.getItem('treat');
           var doctor = localStorage.getItem('doctor');
           var spe = localStorage.getItem('spe');
            
           var donselect = localStorage.getItem('donselect'); 
            
            //myWin.document.write('<title>Données récupérées </title>');
            
            
            //alert("Nom : "+ fname + "")  //a modif
            //window.location="#page4";
            //$("#page4").load("Nom : " + fname);
            
        
        
            //myWin.document.write("Nom: " +  fname +"<br>");
            //myWin.document.write("Prénom: " +  lname +"<br>");
            
            
            
            //myWin.document.write("Taille (en cm): " + slider1 +"<br>");
            
            //myWin.document.write("<input type='button' id='btnReturn' value='Retour'  onclick='window.close()' />");
            
            $("#content4").html(function(){
                // attacher les retours sinn il ne remet que la first ligne ou crée une autre fonction avec return
           
    return "Nom: " +  fname +"<br>"+"Prénom: " +  lname +"<br>"+ "Date de naissance: " + bday +"<br>"+"Sexe: " + sexe  +"<br>"+"Taille (en cm): " + slider1 +"<br>"+"Poids (en kg): " + slider2 +"<br>"+"Nationalité: " + nation +"<br>"+"Numéro de Registre National: "+ ID +"<br>"+"Groupe Sanguin: "+ select +"<br>"+"Pathologies: "+ patho +"<br>"+"Chirurgies: " +  chir +"<br>"+"Allergies: " +  allerg +"<br>"+"Traitements suivis: " +  treat +"<br>"+"Médecin Traitant: " +  doctor +"<br>"+"Médecins Spécialisés: " +  spe +"<br>"+"Donneur d'organe: " +  donselect +"<br>";
                       
            });
            
            
          };
          
          function clearData(){
                       
              //localStorage.clear();
              $( "#popup2" ).popup( "open" );// ouvre le popup avec le choix
              
             // $( "#popup3" ).popup( "open" );
          };
          
              //failed test
              //$( "#popup2" ).popup( "open" , { dismissible: false });
              //$( "#popup2" ).popup( "open" );
              //$( "#popup2" ).popup( "open" );
              //var conditionYes =$("yes").on("click", function() { });
              //var conditionNo =$("cancel").on("click", function() {
              
                        //$( "#popup2" ).popup( "close" );
                    
                       // });
                //localStorage.clear();
                //$( "#popup2" ).popup( "close" );    
                    //});             
                    //document.getElementById("yes").addEventListener("click", function() { 
                
                    //localStorage.clear();
                   // $( "#popup2" ).popup( "close" );
    
                   //});
                    
                    
                   // document.getElementById("cancel").addEventListener("click", function() { 
                
                    
                   // $( "#popup2" ).popup( "close" );
    
                  //  });
                
                
              //  $("yes").on("click", function() { 
                
                   // localStorage.clear();
                  //  $( "#popup2" ).popup( "close" );
    
                  //  });
        
        
        
                
        
                //$("cancel").on("click", function() { 
              
                 
                 //$( "#popup2" ).popup( "close" );
                    //});
          // $( "#popup2" ).popup( "open" );
                
        
             //if (conditionYes) {
                    
                    
              
                        //localStorage.clear();
                       // $( "#popup2" ).popup( "close" );    
                                
                    
                    
                    
                    
	// code to be executed if condition is true
                    //}
               // else {
                    //conditionNo;
                    
                    
              
                 
                 
                   
                    
                    
	// code to be executed if condition is false
            //}
            
            
            //!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!Urgences +Json!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
            
            var g_data;
            var stack = [];
		//var donnees;
		function click_cat(categorie) {
			// si ce n'est pas l'initialisation, on redefinit le referenciel
			if(categorie != "init")
			{
			        stack.push({data: g_data, title: categorie});
					g_data = g_data[categorie];
					$('#h3-title').text(categorie);
					
			}
			else 
			{
				set_g_data();
			    $('#h3-title').text('Urgences');
                stack.pop({data: g_data, title: categorie});
			}
			
			var cats=g_data;			
			
			$("#content3").text("");
			var c = document.getElementById("content3");			
			
			if (typeof g_data === 'string') //Si on est au text final
			{
				c.innerHTML += g_data + '<br>';
			}
			else // display cats
			{
				for (var prop in cats) {
					c.innerHTML += '<a onclick="click_cat(\''+prop+'\')" data-role="button" data-theme="c">' + prop + '</a><br>';
					$("#content3").trigger("create");
				}
			}
		};
		
		function set_g_data() {				
				$.ajax({
					url: "json/TheJson.json",
					async: false,
					dataType: 'json',
					success: function(data) {
						g_data = data;						
					},
					error: function(error, texterror, other){
					}
				});	
		};
		
		$(document).ready(function() {
			set_g_data();
			click_cat("init");
		});
              
              
                 
          
          
          
            
            
        </script>
        
        
        
        
    </head>
    
    <body>
        
        <!-- début page d'accueil-->
         <div data-role="page" id="home" data-theme="a">
        
        <div data-role="header" data-theme="a" id="h1" >
            <h1> Premiers Soins </h1>
            
            
        </div>
<!-- /header -->   

        <div data-role="content" id="content1" data-theme="a">
            
            
            <ul data-role="listview" >
                <li><a href="#page2" data-transition='flip'>
         <!--thumbnails--> <img src="css/themes/images/Digit.png" class='ui-li-has-thumb'/> <!-- classe importante sinn l'image ne se voit pas bien-->
                        <h3> Fiche personnelle </h3>
                        <p>Vous pouvez créer votre carnet de santé virtuel</p>
                        
                    </a>
               </li> 
               
                <li><a href="#page3" data-transition='flip'>
                       <img src="css/themes/images/redcross.png" class='ui-li-has-thumb'/> 
                       
                        <h3> Urgences </h3>
                        <p>Vous pouvez consulter toutes les informations nécessaires à votre santé</p>
                        <p>Informations à consulter en cas d'accidents</p>
                        <p>Mesures de sécurité</p>
                        <p>...</p>
                    </a>
               </li>
           </ul>
            
            
  
    
  </div>



            
            
        
<!-- /content -->    

        <div data-role="footer" data-theme="a" data-position="fixed" data-id="foot " id="navbar"> <!--je test juste la navbar-->
            <div data-role="navbar">
                <ul>
                    <li><a href='#home' data-role="button" data-icon="home" id="homefoot" data-transition='slideup'>Home</a></li>
                    <li><a href='#page2' data-role="button" data-icon="grid" id="fichefoot" data-transition='slideup'>Fiche Perso</a></li>
                    <li><a href='#page3' data-role="button" data-icon="plus" id="urgfoot" data-transition='slideup'>Urgences</a></li>
                </ul> 
            </div>    
        </div>

       
    </div>
             
        
        
        <!-- fin page d'accueil-->
        
        
        <!--début  fiche perso-->
        
        <div data-role="page" id="page2" data-theme="b" ><!-- avec class="ui-responsive-panel" le form s'adapte 
                                                         quand on ouvre le panel mais dans notre cas nous avons des radiobuttons=>aucun effet-->
            <div data-role="header" data-theme="b" id="h2" >
            <h1> Fiche personnelle  </h1>
            
            
            </div>
            
            
            
         <div data-role="content" data-theme="b" id="content2">
             
             <!--Test-->
             <form method="post" action="form.asp" id="myForm">
       <div class="ui-field-contain ui-page-theme-b"> <!-- on y change la couleur,... seulement du formulaire-->
        
        <div data-role="fieldcontain" >   
        <label for="fname">Nom:</label>
    	<input type="text" name="fname" id="fname" placeholder="Veuillez introduire votre nom">
    	
    	<label for="lname">Prénom:</label>
    	<input type="text" name="lname" id="lname" placeholder="Veuillez introduire votre prénom">
        
        <label for="bday">Date de Naissance:</label>
    	<input  type="date" name="bday" id="bday" >
        
        </div>
        
        <div data-role="fieldcontain" > 
        <fieldset data-role="controlgroup" >
        <legend>Sexe:</legend>
                      <label for="male">Homme</label>
                      <input type="radio" name="gender" id="male" value="Homme">
                      <label for="female">Femme</label>
                      <input type="radio" name="gender" id="female" value="Femme"> 
        </fieldset>
        
        </div>
      
 	   
            <div data-role="fieldcontain">
	    <label for="slider1">Taille (en cm):</label> <!-- pas visible à cause du browser utilisé-->
	    <input   type="range" name="slider1" id="slider1" value="170" min="50" max="250"  data-highlight="true" data-show-value="true" data-popup-enabled="true"  data-theme='b' data-track-theme="b"/> 
            </div>
        
	    <div data-role="fieldcontain">
	    <label for="slider2">Poids (en kg):</label> <!-- pas visible à cause du browser utilisé-->
	    <input   type="range" name="slider2" id="slider2" value="70" min="25" max="150"  data-highlight="true" data-show-value="true" data-popup-enabled="true"  data-theme='b' data-track-theme="b" />
        
 	    
            
            <div data-role="collapsible"  data-collapsed="true" data-theme="b"  data-content-theme="b" >
            <h4> Remarque </h4>
            <p>Si votre poids n'est pas compris dans cet intervalle ou votre IMC n'est pas normale, veuillez consulter votre médecin </p>
            </div>
            </div>
           
           
           
           <div data-role="fieldcontain">
                <label for="nation">Nationalité:</label>
                <input type="text" name="nation" id="nation" placeholder="Nationalité">
               
               
            </div>
        
 	    
 	    <div data-role="fieldcontain">
	

            
            <label for="ID">Numéro de registre nationale:</label>
    	    <input  type="text" name="ID" id="ID" required pattern="\d{11}|\d{6} \d{3} \d{2}|\d{6}.\d{3}.\d{2}" placeholder="xxxxxx.xxx.xx" MAXLENGTH="13">
 	     
 	    
            
            
 	     <div data-role="collapsible"  data-collapsed="true" data-theme="b"  data-content-theme="b" >
        <h4> Informations complèmentaires </h4>
        <p> *Vous trouverez votre numéro de registre national dans le coin supérieur gauche au verso de votre carte d'identité</p>
        <p> *Veuillez respectez le format d'écriture ex: 870214.375.95</p>
        </div>
            </div>
        
            <div data-role="fieldcontain">
                    <label for="select">Groupe sanguin:</label>
                    <select name="select" id="select" data-native-menu="false"> <!--n'est pas activé directement à la création de lapage-->
                        <option value="N/A" data-placeholder="true">Choisissez en un...</option>
                        <option value="A+">A+</option>
                        <option value="A-">A-</option>
                        <option value="B+">B+</option>
                        <option value="B-">B-</option>
                        <option value="AB+">AB+</option>
                        <option value="AB-">AB-</option>
                        <option value="O+">O+</option>
                        <option value="O-">O-</option>
        
        
                    </select>
            </div>
        
        <div data-role="fieldcontain" >
        
        <label for="patho">Pathologies:</label>
        <textarea name="patho" id="patho" placeholder="diabétique, problèmes cardiaques..."></textarea>
        
        
        <label for="chir">Chirurgies:</label>
        <textarea name="chir" id="chir" placeholder="pace maker, broches..."></textarea>
        
        
        <label for="allerg">Allergies:</label>
        <textarea name="allerg" id="allerg" placeholder="allergie connue (à un médicament,...)"></textarea>
        
        
        <label for="treat">Traitements suivis:</label>
        <textarea name="treat" id="treat" placeholder="traitement actuel"></textarea>
        
        
        <label for="doctor">Médecin traitant:</label>
    	<input  type="text" name="doctor" id="doctor" placeholder="médecin principal" >
        
        <label for="spe">Médecins spécialisés:</label>
        <textarea name="spe" id="spe" placeholder="médecin spécialiste + spécialité,..."></textarea>
        
        <div data-role="fieldcontain">
            
             <label for="flip">Donneur d'organe:</label>
                    <select name="donselect" id="donselect" data-role='slider'> <!-- la valeur par défaut sera Non -->
                        <option value="Non">Non</option>
                        <option value="Oui">Oui</option>
                       
        
        
                    </select>
            
        </div>
        
            
        
        <div data-role="fieldcontain">
            
            
            
            
            
            <input type="button" value="Enregistrer" id="enregistrer" data-icon="check" data-iconpos="top" data-inline="true" >
           <!-- <input type="button" value="Récupérer" id="rec" data-icon="search" data-iconpos="top" data-inline="true" >-->
           
           <a href="#page4" data-role="button" data-transition='pop' id="rec" data-icon="search" data-iconpos="top" data-inline="true">Récupérer</a>
            <input type="button" value="Reset" id="reset"  data-icon ="alert" data-iconpos="top" data-inline="true" >
           
        </div>
        
      
           <div data-role="fieldcontain">
            
                <div data-role="collapsible"  data-collapsed="true" data-theme="b"  data-content-theme="b" >
        <h4> Informations sur la sauvegarde! </h4>
        <p> Faites glisser votre écran vers la gauche</p>
     
        </div>
            
            
            
            
           
            </div>
        
        
        </div>
        
        
             
             <!-- fin Test-->
             
          
         </div>
                  <!--panel-->
                 <div data-role="panel"  id="myPanel" data-theme="a" data-display="overlay" data-position="right" ><!-- overlay comme ça notre panel couvre le form-->
                     <a href="" data-role="button"  data-rel="close">Close Me!</a> 
                     
                     
                     <p>Les données enregistrées restent stockées dans la mémoire de votre mobile device.
                         Si vous souhaitez revendre ce dernier, n'oubliez pas d'effacer vos données personnelles
                         afin d'éviter tout malentendu.Merci à vous! 
                     
                     
                     </p>
                 </div>
                 <!--popups-->
                <div data-role="popup" id="popup1" data-transition="slideup" data-theme="a">
                    <p>Vos données ont bien été sauvergadées!</p>
                </div>
                 
                <div data-role="popup" id="popup2" data-transition="pop" data-theme="a"   ><!-- data-dismissible="" je crée une dialog box modale on ne sait   pas cliquer à l'extérieur pour la fermer et je le laisse 
                                                                                                              sans argument comme ça je sais le modif dans le js-->
                 <div data-role="header" data-theme="a" >
                        <h1> Last Words?!</h1>
                    </div>                                                                                  
                    <div data-role="content" data-theme="a" >
                
                        <input type="button" value="Oui" id="yesErase"  data-icon ="check"  data-inline="true">
                        <input type="button" value="Annuler" id="cancel"  data-icon ="delete"  data-inline="true">
                     
                    </div>
                </div>
                
                
                
                
                <div data-role="popup" id="popup3" data-transition="slideup" data-theme="a">
                    <p>Vos données ont bien été effacées!</p>
                </div>
                   <!-- <div data-role="header" data-theme="a" >
                        <h1> Last Words?!</h1>
                    </div>
                    
                    <div data-role="content" data-theme="a" >
                     
                     
                     <input type="button" value="Oui" id="cancel"  data-icon ="check"  data-inline="true">
                     <input type="button" value="Annuler" id="cancel"  data-icon ="delete"  data-inline="true">
                     </div>
                    
                    <div data-role="footer" data-theme="a">
                        <h2>Suppression de données</h2> 
                        
                    </div>
                    
                </div> -->
                   
                   
                   
                 
                 <!--dialog modal test
                 
                 <div data-role='dialog' id='dialogM' data-theme='a'>
                     
                     <p>Test</p>
                     
                 </div>-->
                 
                 
                 
                 
                 
             </form><!--fin du form-->
         
             
             
            
             <div data-role="footer"  data-theme="b" id="foot2" ><!--data-position="fixed"-->
             <a href="#home" data-transition='slide' data-icon="back">Retour</a>
             
           </div>  
        </div>
            </div>
            <!-- fin fiche perso-->
            
            
            
            
            
            
        <!--début  Urgences-->
        
        <div data-role="page" id="page3" data-theme="c">
            <div data-role="header" data-theme="c" id="h3" >
                
            <a href="#home" data-transition='slide' data-icon="home">Home</a>
             
            <h1 id="h3-title"> Urgences </h1>
            
            
            </div>
            
            
            
         <div data-role="content" data-theme="c" id="content3">
          
            
             
             
         </div>
            
            
         <div data-role="footer"  data-theme="c" id="foot3" data-position="fixed">
             <a onclick='click_cat("init")' data-role="button"  data-icon="back" >Précédent</a><!-- add data  reverse back button pour back dans les categories-->
             
           </div>  
        </div>
            <!-- fin Urgences-->
            
            
            
            
            <!--Données enregistrées-->
           <div data-role="page" id="page4" data-theme="b">
            <div data-role="header" data-theme="b" id="h4" >
            <h1> Données enregistrées </h1>
            <a href="#page2" data-direction="reverse" data-icon="back">Retour</a>
            
            </div>
            
            
            
         <div data-role="content" data-theme="b" id="content4">
          
            
             
             
         </div>
            
            
         <div data-role="footer"  data-theme="b" id="foot4" data-position="fixed">
             
             
           </div>  
        </div> 
            
            
            
      
           <!-- /test--> 
           <!-- Demarche--> 
           
              <div data-role="page" id="Demarche" data-theme="c">
            <div data-role="header" data-theme="b" id="h5" >
            <h1> Demarche</h1>
            <a href="#page3" data-direction="reverse" data-icon="back">Retour</a>
            
            </div>
            
            
            
         <div data-role="content" data-theme="b" id="content5">
          
            
             
             
         </div>
            
            
         <div data-role="footer"  data-theme="b" id="foot5" data-position="fixed">
             
             
           </div>  
        </div> 
            
            <!-- /test--> 
            
            
            
            
            
    </body>
</html>
